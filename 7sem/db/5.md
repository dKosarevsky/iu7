[К списку вопросов](db_exam.md)

# 5. Язык SQL. DDL. Объекты РБД: таблицы. Синтаксис создания таблиц на примере произвольного диалекта SQL. Указание первичных и внешних ключей, обязательности значений, значений по умолчанию, а также других видов ограничений. Создание автоматически генерируемого значения для первичного ключа. Рекомендации при проектировании таблиц в РБД.

## Язык SQL

**История**
- В начале 1970-х гг. Э.Ф.Кодд, работавший в IBM, разработал теорию РБД
- Для воплощения идей РМД он разработал язык для РБД - Alpha
- разработку передали группе, неподконтрольной Кодду
- Нарушив некоторые принципы РМ, она была реализована в экспериментальной СУБД IBM System R
- Для IBM System R был разработан специальный язык SEQUEL (Structured English Query Language)
- Поскольку SEQUEL был зарегистрированной торговой маркой, название для стандарта сократили до SQL
- Сейчас SQL реализован во всех СУРБД
- Ни в одной СУРБД SQL не реализован в чистом виде - в каждой поддерживается свой диалект

**Стандартизация**
- Стандарт ISO/IEC 9075 “Database Language SQL”
- Первая версия – 1986 г.
- Наиболее свежая версия – 2016 г.

Стандарт включает 9 разделов:
- 9075-1, SQL/Framework; 
- 9075-2, SQL/Foundation; 
- 9075-3, SQL/CLI; (call level interface – спецификация интерфейса уровня вызова) 
- 9075-4, SQL/PSM; (persistent stored modules – спецификация хранимых процедур) 
- 9075-9, SQL/MED; (management of external data – управление внешними данными) 
- 9075-10, SQL/OLB; (связывание с объектно-ориентированными языками программирования) 
- 9075-11, SQL/Schemata; 
- 9075-13, SQL/JRT; (Java runtime – использование  подпрограмм и типов SQL в языке программирования Java) 
- 9075-14, SQL/XML. (спецификации языковых средств, позволяющих работать с XML-документами в среде SQL)

**Язык:**
- Декларативный с элементами процедурного, с сильной статической типизацией
- Расширение файлов: “.sql”
- Нечувствительный к регистру
- Чаще всего синтаксические конструкции пишут в верхнем регистре, а имена – согласно соглашению именования в команде

**Диалекты**
Реализован в различных СУБД в виде диалектов, расширяющих стандарт SQL: 
- Transact-SQL или T-SQL в Microsoft SQL Server
- PL/pgSQL в PostgreSQL
- PL/SQL в Oracle
- SQL/PSM в MySQL
- SQL PL в IBM DB2
- SPL в IBM Informix
- И т.д.

**Классификация инструкций**
- Data definition language (DDL)
- Data manipulation language (DML)
- Data control language (DCL)

**Инструкции DDL:**
- CREATE – создаёт объект БД (саму базу данных, таблицу, представление, хранимую процедуру, функцию, индекс и т. д.)
- DROP – удаляет существующий объект
- ALTER – изменяет существующий объект
- RENAME – переименовывает таблицу в БД
- TRUNCATE – удаляет все строки в таблице

**Инструкция CREATE**

Синтаксис:
```postgresql
CREATE DATABASE [database_name]
CREATE TABLE [table_name] ( [column_definitions] ) [table_parameters]
```

Пример:
```postgresql
CREATE DATABASE my_db;
CREATE TABLE my_db.employees (
    id            SERIAL PRIMARY KEY,
    department_id INT         NOT NULL
        constraint employees_department_id_fk references my_db.departments,
    first_name     VARCHAR(50) NOT NULL,
    last_name     VARCHAR(75) NOT NULL,
    middle_name   VARCHAR(50) NOT NULL,
    date_of_birth DATE        NOT NULL,
    phone         VARCHAR(20) default NULL
);
```

## Рекомендации при проектировании таблиц
Нормальные формы – это рекомендации по проектированию баз данных. Вы не обязаны придерживаться всех пяти нормальных форм при проектировании баз данных. Тем не менее, рекомендуется нормализовать базу данных в некоторой степени потому, что этот процесс имеет ряд существенных преимуществ с точки зрения эффективности и удобства обращения с вашей базой данных.

- В нормализованной структуре базы данных вы можете производить сложные выборки данных относительно простыми SQL-запросами.
- Целостность данных. Нормализованная база данных позволяет надежно хранить данные.
- Нормализация предотвращает появление избыточности хранимых данных. Данные всегда хранятся только в одном месте, что делает легким процесс вставки, обновления и удаления данных. Есть исключение из этого правила. Ключи, сами по себе, хранятся в нескольких местах потому, что они копируются как внешние ключи в другие таблицы.
- Масштабируемость – это возможность системы справляться с будущим ростом. Для базы данных это значит, что она должна быть способна работать быстро, когда число пользователей и объемы данных возрастают. Масштабируемость – это очень важная характеристика любой модели базы данных и для РСУБД.
